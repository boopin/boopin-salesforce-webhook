
{% extends "base.html" %}
{% block content %}
<div class="text-center my-4">
  <img src="https://i.imgur.com/CsnXPLZ.jpeg" alt="Boopin Logo" height="60">
  <h1 class="mt-3">Boopin Webhook</h1>
  <p class="lead">Welcome to <strong>Boopinâ€™s Salesforce Lead Integration Tool.</strong><br>
  Manage and monitor leads from TikTok and Snapchat in real-time.</p>
</div>

{% if failed_count > 5 %}
<div class="alert alert-danger text-center fw-bold">
  âš ï¸ Warning: High number of failed leads ({{ failed_count }}) detected!
</div>
{% endif %}

<div class="d-flex justify-content-end align-items-center mb-2">
  <span class="me-2">Auto-Refresh Stats</span>
  <input type="checkbox" checked class="form-check-input">
</div>

<div class="row text-center mb-4">
  <div class="col-md-4">
    <div class="bg-white shadow-sm rounded p-3 border border-primary">
      <h5 class="text-primary">ğŸ“ˆ Total Leads Submitted</h5>
      <h2 class="text-primary" id="lead-count">{{ lead_count }}</h2>
    </div>
  </div>
  <div class="col-md-4">
    <div class="bg-white shadow-sm rounded p-3 border border-secondary">
      <h5 class="text-muted">ğŸ•’ Last Submission</h5>
      <h2 class="text-muted" id="last-submission">{{ last_time or '-' }}</h2>
    </div>
  </div>
  <div class="col-md-4">
    <div class="bg-white shadow-sm rounded p-3 border border-danger">
      <h5 class="text-danger">âŒ Failed Leads</h5>
      <h2 class="text-danger">{{ failed_count }}</h2>
    </div>
  </div>
</div>

<div class="d-grid gap-2 col-lg-6 mx-auto">
  <a href="/form" class="btn btn-primary btn-lg">ğŸ“© Submit Test Lead</a>
  <a href="/logs" class="btn btn-outline-secondary">ğŸ“„ View Lead Logs</a>
  <a href="/failed-logs" class="btn btn-outline-danger">ğŸš« View Failed Logs</a>
  <a href="/dashboard" class="btn btn-outline-info">ğŸ“Š View Dashboard</a>
  <a href="/download-log" class="btn btn-outline-dark">â¬‡ï¸ Download CSV</a>
  <a href="/export-excel" class="btn btn-success">ğŸ“¥ Export to Excel</a>
</div>

<script>
  // Auto-refresh every 30 seconds
  setInterval(() => {
    fetch('/api/stats')
      .then(response => response.json())
      .then(data => {
        document.getElementById("lead-count").textContent = data.lead_count;
        document.getElementById("last-submission").textContent = data.last_time || '-';
      });
  }, 30000);
</script>
{% endblock %}
